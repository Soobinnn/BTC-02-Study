# 블록체인 트릴레마

## **Achievement Goals**

- 블록체인 트릴레마(Trilemma)
    - 확장성, 탈중앙화, 보안성이 가지는 의미
    - 확장성, 탈중앙화, 보안성이 약하면 생기는 문제
    - TPS가 중요한 이유를 이해하고, 한계에 부딪히는 이유
    - 비트코인, 이더리움, 이오스의 트릴레마
- 블록체인에서 트릴레마를 고려해야하는 이유
    - 블록체인 트릴레마 문제를 해결하기 위한 다양한 방안
- 블록체인의 Safety와 Liveness, Finality
- 비잔틴 장군 문제
- 합의 알고리즘
    - PoW, PoS, DPoS의 차이
- 합의 알고리즘
    - PoW, PoS, DPoS의 차이

확장성, 탈중앙화, 보안 - 블록체인 기술을 구현할 때 최소한 고려되어야 하는 기능

트릴레마(Trilemma) = Tri (3) + Lemma (명제)
-> 3가지의 문제가 각각 서로 영향을 주어, 3가지 중 어느것을 선택하면, 다른 부분이 악화된다.
블록체인 트릴레마(Blockchain Trilemma)는 확장성, 탈중앙화, 보안이라는 세 가지 요소를 모두 만족하는 일이 얼마나 어려운지를 의미.

- 확장성(scalability)
    사용자 수가 늘어나더라도, 유연하게 대응할 수 있는 정도
    -> 확장성이 높으면 사용자수의 증가에 따라 거래건수가 늘어나더라도, 무리없이 전송 처리용량을 증가시킬 수 있음.
    \* TPS(Transaction-Per-Second)가 높다고도 표현

- 탈중앙화(decentralization)
    중앙집권화를 벗어나 분산된 소규모 단위가 모여, 자율적으로 운영되는 방식
    블록체인은 기존의 서버-클라이언트 관계가 아니라, 개별 노드들의 자발적이고 자율적인 연결에 의해 P2P(Peer-to-Peer) 방식으로 동작

- 보안(security)
    블록체인 내의 데이터나 프로그램을 권한이 없는 이용자가 사용할 수 없도록 하는 제한하여, 외부의 공격으로부터 프로그램을 보호

### 확장성
확장성 문제는 확장성이 커지면서 발생하는 일련의 문제. 또는 확장성이 커지면서 해결하지 못하는 문제를 뜻함.

* 비트코인은 확장성이 제한적이어서 비트코인 캐시로 하드포크하며, 블록사이즈를 키워 블록 크기를 2~8MB까지 유동적으로 늘리는 정책을 적용 - (2018년 32MB 업그레이드 이후, 현재 32MB 유지)

이더리움 또한 확장성이 문제가 되어 다양한 알트코인이 등장. -> 그만큼 확장성은 블록체인에서 반드시 해결해야할 핵심 요소 중 하나

\*블록체인 네트워크가 트랜잭션을 얼마나 빠르게 처리를 할 수 있는지를 나타냄.
-> TPS는 초당 트랜잭션 처리 속도로, 블록체인 네트워크의 성능지표로 사용
비트코인과 이더리움은 확장성의 문제로 인해 초당 트랜잭션 처리량(TPS)이 적다. -> 트랜잭션 처리에 드는 수수료가 비싸지는 이유
따라서, 확장성을 블록체인의 트랜잭션 처리속도로 이해해도 무방
높은 TPS를 가진 네트워크는 사용자가 많아지더라도, 네트워크를 안정적으로 운용할 수 있다.

\*주의) TPS만으로 확장성을 설명하기에는 부족함. 
 확장성을 이해하는 데에 TPS가 도움이 되는 것이지, TPS를 확장성으로 이해하는 것은 잘못된 내용을 받아들일 수 있음.
 확장성을 설명할 때의 TPS를 레드 헤링(Red Herring)이라고도 함. -> 주의를 다른 곳으로 분산시키는 무언가를 지칭할 때 주로 사용하는 단어
  확장성을 설명하는 데에 있어 TPS는 확장성을 쉽게 이해할 수 있도록 돕기도 하지만, 확장성이라는 개념을 TPS와 같다고 이해하기에는 무리가 있다.

E.O.S(EOS; 이오스)는 3천 TPS를 돌파하며, 많은 서비스에서 상용화할 수 있는 블록체인 네트워크로 개발됨.
그러나 1초에 6,000건 이상의 트랜잭션을 유발하는 Dapp이나 토큰이 생긴다면, 이오스마저도 비트코인이나 이더리움처럼 병목현상을 보일 수 있다.

이오스처럼 2세대 암호화폐의 이슈를 해결하기 위한 암호화폐를, 3세대 코인이라고도 합니다. 확장성을 개선하기 위한 3세대 암호화폐는 대표적으로 이오스, 트론, 에이다, 이오스트

확장성은 높은 트랜잭션 처리량과 미래 성장을 지원하는 능력으로 표현하기도 합니다. 확장성이 있는 블록체인 프로토콜은 사용 사례가 확장되고 블록체인 기술의 채택이 가속화되더라도 블록체인의 성능이 전혀 저하되지 않음.

여러 dApp이나 토큰을 기획하는 개인이나 회사가 블록체인 프로토콜을 채택하는 일이 증가할 때마다 성능이 저조해지는 블록체인은 확장성이 부족하다고 함.
더 큰 확장성을 실현하려고 시도할 수 있지만, 탈중앙화나 보안에 대해 결과적으로 어려움을 겪을 수 있다.

많은 블록체인 플랫폼이 탈중앙화와 보안을 확립했지만 동시에 확장성을 달성하는 것은 오늘날 탈중앙화 네트워크의 주요 과제로 남아 있다.

\* 1, 2, 3세대를 나누는 기준은 일반적으로 비트코인, 이더리움, 이오스
-> 그러나 이것은 논쟁의 여지가 있는 지나치게 단순한 해석

### 탈중앙화
네트워크가 중앙집권화된 서버로 운영이 되는 것이 아닌 소규모 노드 간 자율적으로 운영

탈중앙화는 블록체인 기술의 핵심 아이디어이며, 블록체인 생태계 전반에 걸쳐 추진

분산된 프로세스와 기술을 적용하면 산업 전반에 걸쳐 중개자의 역할이 사라지고 더욱 다양한 방식의 거래형태

탈중앙화 네트워크는 훨씬 더 기본적인 수준에서 합의(Consensus)를 통해 의사결정을 내림.

누구도 이를 통해 거래되는 데이터를 제어하거나 검열할 수 없다.

그러나 최적의 탈중앙화를 달성하면, 네트워크 처리량이 감소하는 경향.

더 많은 채굴 노드의 합의를 통해 네트워크를 보호하면 트랜잭션 속도(TPS)가 떨어짐.
-> 이런 문제점은 다양한 서비스에서 블록체인 네트워크를 채택하는 장애물


### 보안
데이터나 프로그램이 보호되어 있고, 권한이 없는 사용자나 악의적인 사용자의 접근을 막는 것

블록체인 위에서 발행된 화폐가 이미 암호화폐(Cryptocurrency)라고 불리는 것처럼, 암호화폐는 암호화되어 있어서 익명성과 함께 안전성을 가짐.

비트코인과 이더리움에 대한 무한한 관심은 바로, PoW와 PoS로 이어지는 해킹 불가능 영역
-> 물론 이런 채굴방식과 합의 알고리즘을 사용하고도 해킹사고가 발생할 수 있습니다. 대표적으로 이더리움 클래식(ETC), 비트코인 골드(BTG)와 같은 코인

이는 노드수가 충분하지 않은 코인과 같은 경우에는 해시율이 낮아져서 해킹 확률이 높아질 수 있고, 이는 알고리즘 허점이라고 보기는 어렵다. 
-> 이런 코인을 51% 공격을 통해 해킹하기 위해서는 장비비를 포함한 엄청난 자금이 필요합니다. 따라서 일반적인 해커가 해킹을 시도하는 일은 현실적으로 어렵습니다. 

## 세 요소의 상호작용과 한계

```
scalability = 1/decentralisation
```
시스템에 많은 수의 참가자가 있는 경우 계약에 시간이 걸릴 수 있다.
-> 확장성은 탈중앙화에 반비례

```
scalability = security
```
보안 측면을 블록체인의 해시율(해시 레이트)

해시 레이트가 높을수록 확인시간이 짧아지고, 보안과 함께 확장성이 높아짐.
-> 지속적인 탈중앙화에서는 확장성과 보안이 비례

\* 이런 이유로, 블록체인은 세 가지 특성을 동시에 최적화할 수 없으며, 상호간의 절충이 필요

->  이더리움의 창시자 비탈릭 부테린은 ‘Scalability Trilemma’을 설명하면서 이 문제를 언급
그러나 트릴레마의 요소 간 충돌 관계를 자세히 들여다 보면, 결국 중앙화와 탈중앙화에 대한 대치되는 관계

모든 요소를 양적(Positive) 방향으로 개선 시킬 수 없습니다. 한 요소를 강화하면, 다른요소에 대한 양보가 필요

issue)
가장 최근에 관찰된 트릴레마에 대한 고민은, 이더리움이었습니다. De-Fi(탈중앙화 금융) 애플리케이션이 떠오르면서, 이더리움 플랫폼 사용량이 급증
-> 이더리움은 특정 수 이상의 트랜잭션이 발생하였을 때, 네트워크에서 이 트랜잭션을 처리하는 속도에 한계가 발생

따라서 수요 증가로 인해 일부 블록체인과의 상호 작용이 금지될 정도로 거래 수수료가 상승

이더리움에 대한 수수료 인상은 트릴레마의 한 예로서 이더리움이 보안이나 탈중앙화를 포기하지 않고는 확장되지 않았다고 볼 수 있다.

이더리움의 경우 탈중앙화와 보안에 중점을 두어 초당 트랜잭션 수(확장성)를 제한.

결국 사용자는, 채굴자가 거래의 우선 순위를 사용자에게 할당하도록 하기 위해 더 높은 수수료를 지불

이더리움, 비트코인 : 확장성 < 탈중앙화, 보안
Ripple : 탈중앙화 < 보안, 확장성
EOS : 탈중앙화,보안 < 확장성

\* 이더리움 런던 하드포크에서 EIP 1559 제안을 적용. -> 수수료 모델 부분에서 많은 개선

EIP-1559의 핵심은 이러한 블록사이즈에 대한 조정, 그리고 채굴자에 대한 보상이 줄어들고 줄어든 만큼의 보상에 대한 소각.
-> 실질적으로 가스비 완화 효과, 소각으로 채굴자에게 집중되어 있는 보상을 네트워크 사용자 전체에게 돌아가도록 만드는 효과

### 탈중앙화
퍼블릭 블록체인은 누구나 사용하고, 노드로써 참여할 수 있습니다. 결정은 합의에 의해 이루어지며, 이는 트랜잭션이 개별 노드가 아닌 노드 그룹에 의해 승인된다는 뜻.

이러한 거래가 합의에 의해 확인되면, 이후에는 변경할 수 없습니다(불변성). 따라서 위험은 하나의 중앙 주체에 배치되지 않으며, 신뢰는 거래를 수행할 때 다른 개인에게 의존하지 않음

그러나 순수한 탈중앙화의 타협점은 속도입니다. 
트랜잭션이 합의에 도달하기 전에 여러 번 확인해야 하는 경우, 본질적으로 단일 엔터티에서 트랜잭션을 확인할 수 있는 경우보다 시간이 더 오래 걸립니다. 
비트코인은 강력하게 분산된 것으로 알려져 있지만, 동시에 매우 느림.

분산 네트워크는 충분히 많은 이해 관계자에게 의존할 수 있는 블록체인의 능력을 강조

분산화는 채굴자 수, 풀 노드 수, 지리적 분포, 활성 개발자 수 등 다양한 수준에서 관찰할 수 있다. 
모든 블록체인이 동일한 정도로 탈중앙화되는 것은 아니라는 점에 유의하는 것이 중요

#### 탈중앙화 네트워크의 장단점
#### 장점
- 탈중앙화를 통해 사용자가 단일 엔티티를 신뢰하지 않고도 합의를 유지

- 분산화는 시스템의 견고성을 증가시키기 때문에 바람직
-> 네트워크를 검열에 저항하게 하여 누구나 네트워크를 사용할 수 있도록 하여 재산권을 향상

#### 단점
- 분산화는 지연을 초래하고 네트워크 속도를 늦춤

- 중복성을 도입하기 때문에 비용이 많이 들고 모든 애플리케이션에 바람직하지 않음


### 확장성
성능 저하 없이 더 많은 사용자, 더 많은 사용 사례 및 궁극적으로 더 많은 트랜잭션을 처리하기 위해 규모의 성장을 지원하는 블록체인 시스템의 용량을 나타냄
-> 본질적으로 TPS(초당 트랜잭션) 또는 체인의 처리량을 늘리기 위해 트랜잭션의 결제 시간을 줄이는 것이 최종 목표

확장성은 대량 채택에 중요합니다. 수많은 사람들이 블록체인 위에서 구현된 dApp을 사용한다면, 이 dApp은 최대한 빠른 속도의 네트워크를 선택할 것임.

\* 비자가 평균 63,000 TPS를 자랑함.
그러나 EOS가 확장됨에 따라 수백만 TPS를 달성한다면, EOS를 채택하지 않을 이유가 없음.
-> 그러나 트릴레마에서 알 수 있듯이, 타협점이 있습니다. EOS는 확장성에 대한 초점을 제공할 수 있지만, 과도한 중앙집권으로 비판받음.

블록체인의 확장성을 증가시키는 두 가지 방법
- 탈중앙화에 대한 타협 - 거래를 검토하는 엔터티의 수를 줄임

- 보안에 대한 타협 - 네트워크의 난이도 감소를 요구하는 블록 타임의 감소

#### 확장성 중심 네트워크의 장단점
#### 장점
- 네트워크가 많은 양의 트랜잭션을 지원할 수 있도록 함.

- 소셜 메시징 애플리케이션과 같이 보안이 주요 초점이 아닌 애플리케이션에서 유용

#### 단점

- 확장성은 보안을 희생해야함,

- 네트워크가 확장됨에 따라 합의 메커니즘도 확장해야 중앙 집중화를 희생할 수 있음.


### 보안
긍정적인 측면에서, 블록체인 생태계의 보안은 소스 코드 자체에 달려 있다.

따라서, 다른 모든 서비스와 마찬가지로, 소스코드를 신중하게 검사해야 합니다. 
그러나 소스 코드의 투명성과 해킹에 성공할 때 얻을 수 있는 이익으로 인해, 블록체인은 해커의 주요 표적이 됨.

보안은 블록체인이 거래를 취소할 수 없도록 하는 능력.
이는 네트워크 참가자가 보상을 받기 위해 리소스를 소비하도록 함으로써 가능합니다. 네트워크 참여자가 더 많은 리소스를 사용할수록 블록체인의 보안이 강화됩니다.

#### 보안 중심 네트워크의 장단점
#### 장점
- 기존 가치 이전보다 빠르고 저렴한 대규모 가치 이전이 가능
- 퍼블릭 블록체인의 보안은 네트워크 참여자로부터 나옵니다. 높은 보안은 복제하기 쉽지 않은 높은 네트워크 효과를 의미

#### 단점
- 더 많은 자원, 다시말해 더 많은 투자가 필요

issue)
> 이더리움 클래식(ETC) 공격에서, 공격자는 4000개 이상의 블록 1을 재구성 했습니다. 
이 과정에서 공격자는 2백만 달러에 가까운 ETC를 지출했습니다. 공격자가 공격에 성공한 이유는 무엇일까요? 
전체 네트워크 해시파워의 51% 이상을 획득하는 데 드는 비용(200만 달러)는 도난당한 가치에 비해 미미했기 때문입니다. 
다시 말해, 이 4000개 블록에 담긴 이더리움 클래식의 가치는 공격자가 사용한 2백만 달러보다 훨씬 많은 가치를 가지고 있었기 때문입니다.

#### 결론

블록체인 트릴레마 : 이 3가지를 모두 충족하는 것은 불가능의 영역

ex) 가격과 서비스, 맛 5천원짜리 라면, 5만원 짜리 라면 -> 상대적으로 더 낫다고 판단할 수는 있지만, 절대적으로 더 낫다고 판단하기는 어렵다고 생각



Question
- 왜 블록체인 네트워크들이 서로 다른 합의 알고리즘을 사용하나요?
- PoW와 PoS의 가장 큰 차이점은 무엇이라고 생각하나요?
- DPoS는 무엇인가요?
- PBFT는 무엇인가요?
- Finality와 Liveness란?
- 컨센서스란?
- Finality가 블록체인에서 중요한 이유는?
- 블록체인에서 TPS가 늘어나면 어떤 문제가 발생하나요? 이러한 문제에 대해 솔루션을 고민해본 적이 있으신가요?
- 블록체인의 견고성과 내구성에 대해 트릴레마와의 연관성은?
- 은행과 블록체인은 다른가요?
- 하이퍼레저와 블록체인의 차이는 무엇인가요?
- BFT와 CFT의 차이점은?