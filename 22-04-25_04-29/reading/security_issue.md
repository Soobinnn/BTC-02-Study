# **구현된 블록체인에서 생길수 있는 보안적 이슈**

- DAO 사건
- 채굴 취약점을 이용한 공격 (사례로)
- 스마트 컨트랙트 해킹

악의적인 공격자에 의한 공격 중, 몇몇 공격들은 구현된 블록체인 자체의 허점을 이용한 공격들이 있습니다. 몇가지 사례를 통해 확인해봅시다.

## **DAO 사건**

### **The DAO**

DAO는 블록체인 기반의 협동 조직으로, 코드로 규칙을 설정하고 실행합니다. DAO는 중앙 집중식 통제 구조를 투자자-이해당사자에 의해 결정되는 기술민주적인(techno-democratic) 접근법으로 대체합니다.

The DAO는 DAO 거버넌스의 초기 구현체이며, 오늘날 DEFi 플랫폼과 같은 블록체인 서비스들에 큰 영향을 미치고 있습니다.

이더리움 프로토콜 개발자인 크리스토프 젠츠(Christoph Jentzsh)는 집단화된 이더리움 기반 투자 조직을 위한 코드를 오픈 소스로 공개하였으며, 이에 기반하여 The DAO는 2016년 4월 30일 이더리움으로 교환하는방식으로 DAO 토큰을 판매하여 자금을 조달했습니다. 그 결과 The DAO 프로젝트에는 약 1억 5,000만 달러(한화 약 1조 7천억 원)가 넘는 자금을 성공적으로 조달하였으며, 이는 역사상 가장 많은 금액이 모인 크라우드 펀딩입니다.

### **The DAO 해킹**

2016년 6월 17일, 악의적인 공격자가 The DAO로부터 자금을 빼낼 수 있는 허점을 발견했습니다. 공격 개시 후 몇시간 동안 약 30만 이더리움이 도난당했으며, 공격자는 자금을 빼돌린 이후 공격을 멈췄습니다.

이 공격에서 공격자는 트랜잭션 이후 DAO의 스마트 컨트랙트가 잔액을 업데이트 하기 전에 이더를 반환하도록 요청을 할 수 있었습니다. 이 요청이 가능했던 이유에는 두가지가 있습니다. 첫번째는, DAO 스마트 컨트랙트를 만든 개발자들이 재귀적 호출 가능성을 고려하지 않고 코드를 작성했기 때문입니다. 두번째는, 스마트 컨트랙트가 송금을 할 때, 자신이 가지고 있는 자금을 송금한 후에, 컨트랙트 내 잔액을 갱신하는 순서로 구성되어 있었다는 점 때문입니다. 스마트 컨트랙트 자금을 송금한 후, 잔액을 갱신하기 전에 재귀적 호출을 하게 되면, 컨트랙트는 계속 자금을 송금하기만 하고 잔액을 갱신하지 않게 됩니다.

중요한 것은 이 버그는 이더리움 자체의 문제가 아니라, 이더리움에 기반을 둔 어플리케이션의 문제였다는 점입니다. 만약 어떤 웹사이트가 제대로 동작하지 않는다고 해서 인터넷 전체에 문제가 있는 것은 아닙니다. 마찬가지로, The DAO에 심각한 버그가 있는 것이지, 이더리움 자체에 문제가 있는 것은 아닙니다. The DAO의 코드는 여러 결함을 가지고 있었으며, 재귀적 호출 문제도 그 중 하나였습니다. 이더리움 커뮤니티와 The DAO 팀은 손실된 토큰에 대한 악용에 대처하기 위해 여러 방법을 제시했습니다.

다행인것은, 자금은 약 28일간 계좌에 홀딩되어야 하기 때문에 공격자가 해당 자금을 빼돌릴 수는 없었습니다. 이더리움은 손실된 자금을 원래 소유자들에게 환불하기 위해 하드 포크를 단행했습니다. 환불을 받는 토큰 소유자에게는 DAO 토큰의 IO(Initial Offering) 당시의 비율과 동일하게, 1 이더 당 100 DAO 토큰으로 지급했습니다.

### **The DAO 사건의 교훈**

현재 The DAO는 더이상 서비스되고 있지 않습니다. 그러나 The DAO는 DAO를 구축하는 개발자들에게 견고한 블록체인 플랫폼 구현의 중요성을 일깨워주었습니다.

The DAO 해킹은 이더리움 블록체인의 문제가 아니라, 공격자가 구현에 사용된 코드의 허점을 사용하여 이루어진 것이기 때문입니다. 만약 코드가 견고하게 작성되었다면, 이러한 해킹을 피할 수 있었을 것입니다.

## **패리티 멀티시그 지갑 동결 사건**

### **패리티 멀티시그 지갑이란?**

이더리움의 공동 설립자이자 CTO인 개빈 우드(Gavin Wood)는 이더리움 인프라를 위한 소프트웨어를 개발하는 비영리 단체인 EthCore를 설립하면서 시작했으며, 후에 패리티 테크놀로지(Parity Technologies)로 이름을 변경하였습니다. 패리티 사의 주요 소프트웨어인 '패리티'는 이더리움 노드 소프트웨어를 위한 웹 인터페이스를 제공하는 이더리움 클라이언트입니다. 패리티에서 사용자는 일반적인 이더 및 기타 토큰 지갑 기능을 사용할 수도 있으며, 이더리움 블록체인에 구축된 스마트 컨트랙트와도 상호작용 할 수 있습니다. 패리티 지갑은 이더 전송을 관리하고, 모든 표준 토큰과 완벽하게 통합되도록 설계되었습니다.

### **패리티 멀티시그 지갑 동결**

멀티시그는 스마트 컨트랙트 소스코드의 형태로 사용자에게 배포됩니다. 누군가가 이 스마트 컨트랙트를 가지고 싶을 때는 레포지토리에서 최신 코드를 가져와 이더리움 블록체인에 해당 컨트랙트를 배포하고, 다음 소유자를 설정하고, 자금을 배치하는 방식입니다. 각 지갑은 이 소스코드의 개별 인스턴스가 됩니다.

패리티의 경우, 자금을 인출할 수 있는 인출 함수 등과 같은 스마트 컨트랙트의 필수적인 로직들은 WalletLibrary라는 이름의 라이브러리에 있습니다. 이 라이브러리는 패리티 멀티시그가 사용하는 스마트 컨트랙트에 기본으로 들어가있습니다. 라이브러리를 사용한 코드 분리는 가스 수수료를 절감하는 등의 장점도 있지만, 라이브러리에 결함이 있다면, 해당 라이브러리를 사용하는 모든 컨트랙트에 영향을 미치게 됩니다.

2017년 11월 6일 한 공격자가 라이브러리를 지갑화하여 해당 지갑을 파괴하는 공격이 벌어졌습니다. 이 공격으로 인해 라이브러리 그 자체를 하나의 지갑으로 초기화하는 것이 가능하고, 지갑화된 라이브러리의 소유자는 해당 지갑을 파괴할(kill) 권한을 가지게 된다는 것이 밝혀졌습니다. 악의적인 공격자가 라이브러리를 지갑으로 만든후 파괴하면서, 라이브러리를 사용하는 모든 컨트랙트가 무용지물이 되어버렸습니다.

WalletLibrary가 배포된 이후 생성된 멀티시그 지갑들은 동결되었습니다. 이 지갑들은 총 587개이며, 총 513,774.16 ETH(오늘날 한화 약 2조 7천억 원)가 동결되었습니다. 이로 인해 패리티 멀티시그 지갑을 사용해 ICO 자금을 보관하던 폴카닷(Polkadot)과 같은 회사들의 자금 역시 동결되었습니다.